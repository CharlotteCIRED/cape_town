read.xlsx('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/flood_plain_grid.xlsx')
library(rgdal)
library(sf)
library(tidyverse)
library(openxlsx)
df = read.xlsx('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/flood_plain_grid.xlsx')
View(df)
duplicated(df$ID) | duplicated(df$ID, fromLast = TRUE)
sum(duplicated(df$ID) | duplicated(df$ID, fromLast = TRUE))
subset_20 = df[df$FL_TYPE == "20yr",]
subset_20
subset_20 = df[df$FL_TYPE == "20yr",]
subset_50 = df[df$FL_TYPE == "50yr",]
subset_100 = df[df$FL_TYPE == "100yr",]
print(subset_20$ID %in% subset50$ID)
print(subset_20$ID %in% subset_50$ID)
sum(subset_20$ID %in% subset_50$ID)
`%notin%` <- Negate(`%in%`)
sum(subset_20$ID %notin% subset_50$ID)
print(subset_20$ID %notin% subset_50$ID)
print(subset_20$ID[subset_20$ID %notin% subset_50$ID])
print(subset_20$ID[subset_20$ID %notin% subset_100$ID])
print(subset_50$ID[subset_50$ID %notin% subset_100$ID])
summary(subset_50$area[subset_50$ID %notin% subset_100$ID])
table(subset_50$area[subset_50$ID %notin% subset_100$ID])
num(df$area)
View(df)
View(df)
df$area = as.numeric(df$area)
summary(subset_50$area[subset_50$ID %notin% subset_100$ID])
df$area2 = as.numeric(df$area)
df$area = as.numeric(df$area)
summary(df$area)
`%notin%` <- Negate(`%in%`)
subset_20 = df[df$FL_TYPE == "20yr",]
subset_50 = df[df$FL_TYPE == "50yr",]
subset_100 = df[df$FL_TYPE == "100yr",]
print(subset_20$ID[subset_20$ID %notin% subset_50$ID])
print(subset_20$ID[subset_20$ID %notin% subset_100$ID])
summary(subset_50$area[subset_50$ID %notin% subset_100$ID])
df2 = subset_50[subset_50$ID %notin% subset_100$ID]
df2 = subset_50[(subset_50$ID %notin% subset_100$ID),]
View(df2)
df2$FL_TYPE = "100yr"
df2 <- rbind(df, df2)
View(df)
df$FL_TYPE[df$FLDL_DESC == "Prinskasteel 100y Floodline"] = "100yr"
df2$FL_TYPE[df2$FLDL_DESC == "Prinskasteel 100y Floodline"] = "100yr"
sum(df$area[df$FL_TYPE == "20yr"])
sum(df2$area[df$FL_TYPE == "20yr"])
sum(df$area[df$FL_TYPE == "50yr"])
sum(df2$area[df$FL_TYPE == "50yr"])
sum(df$area[df$FL_TYPE == "100yr"])
sum(df2$area[df$FL_TYPE == "100yr"])
spatial_df = st_read('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/flood_plain_grid.shp')
plot(spatial_df)
table(df$FLDL_DESC)
library(rgdal)
library(sf)
library(tidyverse)
library(openxlsx)
###
flood_plain = st_read("C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/WBUS2_data.gdb", layer = "FLOODPLAINS")
grid = st_read("C:/Users/Charlotte Liotta/Desktop/cape_town/data_Cape_Town/data_maps/grid_reference_500.shp")
st_crs(flood_plain) = st_crs(grid)
flood_plain$FL_TYPE[flood_plain$FLDL_DESC == "Prinskasteel 100y Floodline"] = "100yr"
flood_plain_20yr = flood_plain[flood_plain$FL_TYPE == '20yr',]
flood_plain_50yr = flood_plain[flood_plain$FL_TYPE == '50yr',]
flood_plain_100yr = flood_plain[flood_plain$FL_TYPE == '100yr',]
flood_plain_in_20yr_not_in_50yr = st_difference(st_buffer(flood_plain_20yr, 0), st_buffer(flood_plain_50yr, 0))
table(flood_plain_in_20yr_not_in_50yr$FL_TYPE)
st_area(flood_plain)
sum(st_area(flood_plain))
sum(st_area(flood_plain_20yr))
sum(st_area(flood_plain_50yr))
sum(st_area(flood_plain_100yr))
sum(st_area(flood_plain_in_20yr_not_in_50yr))
sum(st_area(st_union(st_buffer(flood_plain_20yr, 0), st_buffer(flood_plain_50yr, 0))))
sum(st_area(st_difference(st_buffer(flood_plain_20yr, 0), st_buffer(flood_plain_50yr, 0))))
View(flood_plain_in_20yr_not_in_50yr)
sum(st_area(st_intersect(st_buffer(flood_plain_20yr, 0), st_buffer(flood_plain_50yr, 0))))
sum(st_area(st_intersection(st_buffer(flood_plain_20yr, 0), st_buffer(flood_plain_50yr, 0))))
sum(st_area(flood_plain_20yr))
sum(st_area(st_intersection(st_buffer(flood_plain_50yr, 0), st_buffer(flood_plain_100yr, 0))))
sum(st_area(flood_plain_50yr))
sum(st_area(st_intersection(st_buffer(flood_plain_100yr, 0), st_buffer(flood_plain_50yr, 0))))
sum(st_area(st_intersection(st_buffer(flood_plain_50yr, 0), st_buffer(flood_plain_100yr, 0))))
sum(st_area(st_intersection(st_buffer(flood_plain_20yr, 0), st_buffer(flood_plain_100yr, 0))))
sum(st_area(st_difference(st_intersection(st_buffer(flood_plain_20yr, 0), st_buffer(flood_plain_50yr, 0)), flood_plain_50yr)))
sum(st_area(st_difference(st_intersection(st_buffer(flood_plain_20yr, 0), st_buffer(flood_plain_50yr, 0)), st_buffer(flood_plain_50yr))))
sum(st_area(st_difference(st_buffer(flood_plain_50yr), st_intersection(st_buffer(flood_plain_20yr, 0), st_buffer(flood_plain_50yr, 0)))))
sum(st_area(st_difference(st_buffer(flood_plain_50yr, 0), st_intersection(st_buffer(flood_plain_20yr, 0), st_buffer(flood_plain_50yr, 0)))))
View(flood_plain_in_20yr_not_in_50yr)
27*23
sum(st_area(st_difference(st_buffer(flood_plain_50yr, 0), st_intersection(st_buffer(flood_plain_20yr, 0), st_buffer(flood_plain_50yr, 0)))))
plot(flood_plain_in_20yr_not_in_50yr[1])
flood_plain = st_read("C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/WBUS2_data.gdb", layer = "FLOODPLAINS")
flood_plain = sf:::as_Spatial(flood_plain$geom)
flood_plain = sf:::as_Spatial(flood_plain$Shape)
flood_plain = readOGR("C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/WBUS2_data.gdb", layer = "FLOODPLAINS")
flood_plain_20yr = flood_plain[flood_plain$FL_TYPE == '20yr',]
flood_plain_50yr = flood_plain[flood_plain$FL_TYPE == '50yr',]
flood_plain_100yr = flood_plain[flood_plain$FL_TYPE == '100yr',]
test = gUnion(flood_plain_50yr, flood_plain_20yr)
library(rgeos)
test = gUnion(flood_plain_50yr, flood_plain_20yr)
plot(flood_plain_20yr)
test = gUnion(flood_plain_50yr, flood_plain_100yr)
gSimplify(flood_plain_50yr)
test = gUnion(gBuffer(flood_plain_50yr, byid = T, width = 0), Buffer(flood_plain_20yr, byid = T, width = 0))
test = gUnion(gBuffer(flood_plain_50yr, byid = T, width = 0), gBuffer(flood_plain_20yr, byid = T, width = 0))
plot(test)
plot(flood_plain_50yr)
plot(flood_plain_20yr)
View(test)
flood_plain_20yr_50yr_and_100yr = gUnion(flood_plain_20yr_and_50yr, gBuffer(flood_plain_100yr, byid = T, width = 0))
flood_plain_20yr_and_50yr = gUnion(gBuffer(flood_plain_50yr, byid = T, width = 0), gBuffer(flood_plain_20yr, byid = T, width = 0))
flood_plain_20yr_50yr_and_100yr = gUnion(flood_plain_20yr_and_50yr, gBuffer(flood_plain_100yr, byid = T, width = 0))
gArea(flood_plain_20yr)
###
gArea(flood_plain_50yr)
gArea(gBuffer(flood_plain_50yr, byid = T, width = 0))
gArea(gBuffer(flood_plain_100yr, byid = T, width = 0))
gArea(flood_plain_20yr_and_50yr)
gArea(flood_plain_20yr_50yr_and_100yr)
grid = st_read("C:/Users/Charlotte Liotta/Desktop/cape_town/data_Cape_Town/data_maps/grid_reference_500.shp")
flood_plain_20yr = st_as_sf(flood_plain_20yr)
flood_plain_50yr = st_as_sf(flood_plain_50yr)
flood_plain_100yr = st_as_sf(flood_plain_100yr)
flood_plain_20yr_and_50yr = st_as_sf(flood_plain_20yr_and_50yr)
flood_plain_20yr_50yr_and_100yr = st_as_sf(flood_plain_20yr_50yr_and_100yr)
flood_plain_50yr = st_as_sf(gBuffer(flood_plain_50yr, byid = T, width = 0))
sum(st_area(flood_plain_20yr))
sum(st_area(flood_plain_50yr))
sum(st_area(flood_plain_100yr))
sum(st_area(flood_plain_20yr_and_50yr))
sum(st_area(flood_plain_20yr_50yr_and_100yr))
st_crs(flood_plain_20yr) = st_crs(grid)
st_crs(flood_plain_50yr) = st_crs(grid)
st_crs(flood_plain_100yr) = st_crs(grid)
st_crs(flood_plain_20yr_and_50yr) = st_crs(grid)
st_crs(flood_plain_20yr_50yr_and_100yr) = st_crs(grid)
flood_plain = readOGR("C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/WBUS2_data.gdb", layer = "FLOODPLAINS")
flood_plain$FL_TYPE[flood_plain$FLDL_DESC == "Prinskasteel 100y Floodline"] = "100yr"
flood_plain_20yr = flood_plain[flood_plain$FL_TYPE == '20yr',]
flood_plain_50yr = flood_plain[flood_plain$FL_TYPE == '50yr',]
flood_plain_100yr = flood_plain[flood_plain$FL_TYPE == '100yr',]
flood_plain_20yr_and_50yr = gUnion(gBuffer(flood_plain_50yr, byid = T, width = 0), gBuffer(flood_plain_20yr, byid = T, width = 0))
flood_plain_20yr_50yr_and_100yr = gUnion(flood_plain_20yr_and_50yr, gBuffer(flood_plain_100yr, byid = T, width = 0))
gArea(flood_plain_20yr)
gArea(gBuffer(flood_plain_50yr, byid = T, width = 0))
gArea(gBuffer(flood_plain_100yr, byid = T, width = 0))
gArea(flood_plain_20yr_and_50yr)
gArea(flood_plain_20yr_50yr_and_100yr)
#flood_plain = st_read("C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/WBUS2_data.gdb", layer = "FLOODPLAINS")
grid = st_read("C:/Users/Charlotte Liotta/Desktop/cape_town/data_Cape_Town/data_maps/grid_reference_500.shp")
flood_plain_20yr = st_as_sf(gBuffer(flood_plain_20yr, byid = T, width = 0))
flood_plain_50yr = st_as_sf(gBuffer(flood_plain_50yr, byid = T, width = 0))
flood_plain_100yr = st_as_sf(gBuffer(flood_plain_100yr, byid = T, width = 0))
flood_plain_20yr_and_50yr = st_as_sf(flood_plain_50yr, byid = T, width = 0)
flood_plain_20yr_50yr_and_100yr = st_as_sf(flood_plain_50yr, byid = T, width = 0)
sum(st_area(flood_plain_20yr))
sum(st_area(flood_plain_50yr))
sum(st_area(flood_plain_100yr))
sum(st_area(flood_plain_20yr_and_50yr))
sum(st_area(flood_plain_20yr_50yr_and_100yr))
flood_plain = readOGR("C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/WBUS2_data.gdb", layer = "FLOODPLAINS")
flood_plain$FL_TYPE[flood_plain$FLDL_DESC == "Prinskasteel 100y Floodline"] = "100yr"
flood_plain_20yr = flood_plain[flood_plain$FL_TYPE == '20yr',]
flood_plain_50yr = flood_plain[flood_plain$FL_TYPE == '50yr',]
flood_plain_100yr = flood_plain[flood_plain$FL_TYPE == '100yr',]
flood_plain_20yr_and_50yr = gUnion(gBuffer(flood_plain_50yr, byid = T, width = 0), gBuffer(flood_plain_20yr, byid = T, width = 0))
flood_plain_20yr_50yr_and_100yr = gUnion(flood_plain_20yr_and_50yr, gBuffer(flood_plain_100yr, byid = T, width = 0))
gArea(flood_plain_20yr)
gArea(gBuffer(flood_plain_100yr, byid = T, width = 0))
gArea(gBuffer(flood_plain_50yr, byid = T, width = 0))
gArea(flood_plain_20yr_and_50yr)
gArea(flood_plain_20yr_50yr_and_100yr)
grid = st_read("C:/Users/Charlotte Liotta/Desktop/cape_town/data_Cape_Town/data_maps/grid_reference_500.shp")
flood_plain_20yr = st_as_sf(gBuffer(flood_plain_20yr, byid = T, width = 0))
flood_plain_50yr = st_as_sf(gBuffer(flood_plain_50yr, byid = T, width = 0))
flood_plain_100yr = st_as_sf(gBuffer(flood_plain_100yr, byid = T, width = 0))
flood_plain_20yr_and_50yr = st_as_sf(flood_plain_20yr_and_50yr, byid = T, width = 0)
flood_plain_20yr_50yr_and_100yr = st_as_sf(flood_plain_20yr_50yr_and_100yr, byid = T, width = 0)
sum(st_area(flood_plain_20yr))
sum(st_area(flood_plain_50yr))
sum(st_area(flood_plain_100yr))
sum(st_area(flood_plain_20yr_and_50yr))
sum(st_area(flood_plain_20yr_50yr_and_100yr))
st_crs(flood_plain_20yr) = st_crs(grid)
st_crs(flood_plain_50yr) = st_crs(grid)
st_crs(flood_plain_100yr) = st_crs(grid)
st_crs(flood_plain_20yr_and_50yr) = st_crs(grid)
st_crs(flood_plain_20yr_50yr_and_100yr) = st_crs(grid)
flood_plain_20yr_grid <- as_tibble(st_intersection(st_buffer(grid, 0), flood_plain_20yr))
plot(flood_plain_20yr)
plot(flood_plain_20yr_grid)
View(flood_plain_20yr_grid)
flood_plain_20yr_grid$area <- st_area(flood_plain_20yr_grid$geometry)
sum(flood_plain_20yr_grid$area)
flood_plain_50yr_grid <- as_tibble(st_intersection(st_buffer(grid, 0), flood_plain_50yr))
flood_plain_50yr_grid$area <- st_area(flood_plain_50yr_grid$geometry)
sum(flood_plain_50yr_grid$area)
flood_plain_100yr_grid <- as_tibble(st_intersection(st_buffer(grid, 0), flood_plain_100yr))
flood_plain_100yr_grid$area <- st_area(flood_plain_100yr_grid$geometry)
sum(flood_plain_100yr_grid$area)
flood_plain_20yr_and_50yr_grid <- as_tibble(st_intersection(st_buffer(grid, 0), flood_plain_20yr_and_50yr))
flood_plain_20yr_and_50yr_grid$area <- st_area(flood_plain_20yr_and_50yr_grid$geometry)
sum(flood_plain_20yr_and_50yr_grid$area)
flood_plain_20yr_50yr_and_100yr_grid <- as_tibble(st_intersection(st_buffer(grid, 0), flood_plain_20yr_50yr_and_100yr))
flood_plain_20yr_50yr_and_100yr_grid$area <- st_area(flood_plain_20yr_50yr_and_100yr_grid$geometry)
sum(flood_plain_20yr_50yr_and_100yr_grid$area)
st_write(flood_plain_20yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/flood_plain_20yr_grid.shp')
st_write(flood_plain_50yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/flood_plain_50yr_grid.shp')
st_write(flood_plain_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/flood_plain_100yr_grid.shp')
st_write(flood_plain_20yr_and_50yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/flood_plain_20yr_and_50yr_grid.shp')
st_write(flood_plain_20yr_50yr_and_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/flood_plain_20yr_50yr_and_100yr_grid.shp')
flood_plain_20yr_grid$ID
flood_plain_20yr_grid = flood_plain_20yr_grid[, c("ID", "area")]
flood_plain_50yr_grid = flood_plain_50yr_grid[, c("ID", "area")]
flood_plain_100yr_grid = flood_plain_100yr_grid[, c("ID", "area")]
flood_plain_20yr_and_50yr_grid = flood_plain_20yr_and_50yr_grid[, c("ID", "area")]
flood_plain_20yr_50yr_and_100yr_grid = flood_plain_20yr_50yr_and_100yr_grid[, c("ID", "area")]
write.xlsx(flood_plain_20yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/flood_plain_20yr_grid.xlsx')
write.xlsx(flood_plain_50yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/flood_plain_50yr_grid.xlsx')
write.xlsx(flood_plain_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/flood_plain_100yr_grid.xlsx')
write.xlsx(flood_plain_20yr_and_50yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/flood_plain_20yr_and_50yr_grid.xlsx')
write.xlsx(flood_plain_20yr_50yr_and_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/flood_plain_20yr_50yr_and_100yr_grid.xlsx')
table(flood_plain_20yr_grid$area)
summary(flood_plain_20yr_grid$area)
summary(flood_plain_20yr_50yr_and_100yr_grid$area)
library(rgdal)
library(sf)
library(tidyverse)
library(openxlsx)
library(rgeos)
library(tiff)
library(raster)
grid = readOGR("C:/Users/Charlotte Liotta/Desktop/cape_town/data_Cape_Town/data_maps/grid_reference_500.shp")
grid <- spTransform(grid, CRS(proj4string(FU_5yr)))
install.packages("exactextractr")
library(exactextractr)
grid = readOGR("C:/Users/Charlotte Liotta/Desktop/cape_town/data_Cape_Town/data_maps/grid_reference_500.shp")
grid <- spTransform(grid, CRS(proj4string(FU_5yr)))
FU_5yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_undefended/FU_1in5.tif')
FU_5yr = crop(FU_5yr, grid)
FU_5yr <- reclassify(FU_5yr, cbind(-9999, NA))
library(rgdal)
library(sf)
library(tidyverse)
library(openxlsx)
library(rgeos)
library(tiff)
library(raster)
library(exactextractr)
FU_5yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_undefended/FU_1in5.tif')
FU_5yr = crop(FU_5yr, grid)
FU_5yr <- reclassify(FU_5yr, cbind(-9999, NA))
grid <- spTransform(grid, CRS(proj4string(FU_5yr)))
grid = readOGR("C:/Users/Charlotte Liotta/Desktop/cape_town/data_Cape_Town/data_maps/grid_reference_500.shp")
FU_5yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_undefended/FU_1in5.tif')
grid <- spTransform(grid, CRS(proj4string(FU_5yr)))
FU_5yr = crop(FU_5yr, grid)
FU_5yr <- reclassify(FU_5yr, cbind(-9999, NA))
FU_5yr <- reclassify(FU_5yr, cbind(999, NA))
cellStats(FU_5yr, 'min')
cellStats(FU_5yr, 'max')
cellStats(FU_5yr, 'mean')
prop_inondable_5yr = FU_5yr
prop_inondable_5yr <- reclassify(prop_inondable_5yr, cbind(NA, 0))
prop_inondable_5yr <- reclassify(prop_inondable_5yr, cbind(!NA, 1))
cellStats(prop_inondable_5yr, 'min')
cellStats(prop_inondable_5yr, 'max')
prop_inondable_5yr <- reclassify(prop_inondable_5yr, cbind(0.005, 10, 1))
cellStats(prop_inondable_5yr, 'max')
FU_5yr_grid = extract(FU_5yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
FU_5yr_grid = data.frame(matrix(unlist(FU_5yr_grid))[,1])
View(FU_5yr_grid)
FU_5yr_grid.desc()
descrive(FU_5yr_grid)
describe(FU_5yr_grid)
sum(FU_5yr_grid)
min(FU_5yr_grid)
max(FU_5yr_grid)
mean(FU_5yr_grid)
nanmean(min(FU_5yr_grid))
nanmean(FU_5yr_grid)
prop_inondable_5yr_grid = extract(prop_inondable_5yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_5yr_grid = data.frame(matrix(unlist(prop_inondable_5yr_grid))[,1])
mean(prop_inondable_5yr_grid)
median(prop_inondable_5yr_grid)
max(prop_inondable_5yr_grid)
min(prop_inondable_5yr_grid)m
min(prop_inondable_5yr_grid)
FU_5yr$prop_inondable = prop_inondable_5yr_grid
prop_inondable_5yr_grid[,1]
FU_5yr$prop_inondable = prop_inondable_5yr_grid[,1]
FU_5yr_grid$prop_inondable = prop_inondable_5yr_grid[,1]
View(FU_5yr_grid)
colnames(FU_5yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(FU_5yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/Cape_Town_data/FU_5yr.xlsx')
write.xlsx(FU_5yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FU_5yr.xlsx')
FU_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_undefended/FU_1in100.tif')
FU_100yr = crop(FU_100yr, grid)
FU_100yr <- reclassify(FU_100yr, cbind(-9999, NA))
FU_100yr <- reclassify(FU_100yr, cbind(999, NA))
cellStats(FU_100yr, 'min')
cellStats(FU_100yr, 'max')
cellStats(FU_100yr, 'mean')
prop_inondable_100yr = FU_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
FU_100yr_grid = extract(FU_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
FU_100yr_grid = data.frame(matrix(unlist(FU_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
FU_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(FU_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(FU_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FU_100yr.xlsx')
P_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/pluvial/P_1in100.tif')
P_100yr = crop(P_100yr, grid)
P_100yr <- reclassify(P_100yr, cbind(-9999, NA))
P_100yr <- reclassify(P_100yr, cbind(999, NA))
cellStats(P_100yr, 'min')
cellStats(P_100yr, 'max')
cellStats(P_100yr, 'mean')
prop_inondable_100yr = P_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
P_100yr_grid = extract(P_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_100yr_grid = data.frame(matrix(unlist(P_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
P_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/P_100yr.xlsx')
FU_20yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_undefended/FU_1in20.tif')
FU_20yr = crop(FU_20yr, grid)
FU_20yr <- reclassify(FU_20yr, cbind(-9999, NA))
FU_20yr <- reclassify(FU_20yr, cbind(999, NA))
cellStats(FU_20yr, 'min')
cellStats(FU_20yr, 'max')
cellStats(FU_20yr, 'mean')
prop_inondable_20yr = FU_20yr
prop_inondable_20yr <- reclassify(prop_inondable_20yr, cbind(NA, 0))
prop_inondable_20yr <- reclassify(prop_inondable_20yr, cbind(0.005, 10, 1))
FU_20yr_grid = extract(FU_20yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
FU_20yr_grid = data.frame(matrix(unlist(FU_20yr_grid))[,1])
prop_inondable_20yr_grid = extract(prop_inondable_20yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_20yr_grid = data.frame(matrix(unlist(prop_inondable_20yr_grid))[,1])
FU_20yr_grid$prop_inondable = prop_inondable_20yr_grid[,1]
colnames(FU_20yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(FU_20yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FU_20yr.xlsx')
FU_1000yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_undefended/FU_1in1000.tif')
FU_1000yr = crop(FU_1000yr, grid)
FU_1000yr <- reclassify(FU_1000yr, cbind(-9999, NA))
FU_1000yr <- reclassify(FU_1000yr, cbind(999, NA))
cellStats(FU_1000yr, 'min')
cellStats(FU_1000yr, 'max')
cellStats(FU_1000yr, 'mean')
prop_inondable_1000yr = FU_1000yr
prop_inondable_1000yr <- reclassify(prop_inondable_1000yr, cbind(NA, 0))
prop_inondable_1000yr <- reclassify(prop_inondable_1000yr, cbind(0.005, 10, 1))
FU_1000yr_grid = extract(FU_1000yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
FU_1000yr_grid = data.frame(matrix(unlist(FU_1000yr_grid))[,1])
prop_inondable_1000yr_grid = extract(prop_inondable_1000yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_1000yr_grid = data.frame(matrix(unlist(prop_inondable_1000yr_grid))[,1])
FU_1000yr_grid$prop_inondable = prop_inondable_1000yr_grid[,1]
colnames(FU_1000yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(FU_1000yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FU_1000yr.xlsx')
