prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
FU_100yr_grid = extract(FU_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
FU_100yr_grid = data.frame(matrix(unlist(FU_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
FU_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(FU_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(FU_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FU_100yr.xlsx')
P_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/pluvial/P_1in100.tif')
P_100yr = crop(P_100yr, grid)
P_100yr <- reclassify(P_100yr, cbind(-9999, NA))
P_100yr <- reclassify(P_100yr, cbind(999, NA))
cellStats(P_100yr, 'min')
cellStats(P_100yr, 'max')
cellStats(P_100yr, 'mean')
prop_inondable_100yr = P_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
P_100yr_grid = extract(P_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_100yr_grid = data.frame(matrix(unlist(P_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
P_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/P_100yr.xlsx')
FU_20yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_undefended/FU_1in20.tif')
FU_20yr = crop(FU_20yr, grid)
FU_20yr <- reclassify(FU_20yr, cbind(-9999, NA))
FU_20yr <- reclassify(FU_20yr, cbind(999, NA))
cellStats(FU_20yr, 'min')
cellStats(FU_20yr, 'max')
cellStats(FU_20yr, 'mean')
prop_inondable_20yr = FU_20yr
prop_inondable_20yr <- reclassify(prop_inondable_20yr, cbind(NA, 0))
prop_inondable_20yr <- reclassify(prop_inondable_20yr, cbind(0.005, 10, 1))
FU_20yr_grid = extract(FU_20yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
FU_20yr_grid = data.frame(matrix(unlist(FU_20yr_grid))[,1])
prop_inondable_20yr_grid = extract(prop_inondable_20yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_20yr_grid = data.frame(matrix(unlist(prop_inondable_20yr_grid))[,1])
FU_20yr_grid$prop_inondable = prop_inondable_20yr_grid[,1]
colnames(FU_20yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(FU_20yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FU_20yr.xlsx')
FU_1000yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_undefended/FU_1in1000.tif')
FU_1000yr = crop(FU_1000yr, grid)
FU_1000yr <- reclassify(FU_1000yr, cbind(-9999, NA))
FU_1000yr <- reclassify(FU_1000yr, cbind(999, NA))
cellStats(FU_1000yr, 'min')
cellStats(FU_1000yr, 'max')
cellStats(FU_1000yr, 'mean')
prop_inondable_1000yr = FU_1000yr
prop_inondable_1000yr <- reclassify(prop_inondable_1000yr, cbind(NA, 0))
prop_inondable_1000yr <- reclassify(prop_inondable_1000yr, cbind(0.005, 10, 1))
FU_1000yr_grid = extract(FU_1000yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
FU_1000yr_grid = data.frame(matrix(unlist(FU_1000yr_grid))[,1])
prop_inondable_1000yr_grid = extract(prop_inondable_1000yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_1000yr_grid = data.frame(matrix(unlist(prop_inondable_1000yr_grid))[,1])
FU_1000yr_grid$prop_inondable = prop_inondable_1000yr_grid[,1]
colnames(FU_1000yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(FU_1000yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FU_1000yr.xlsx')
library(rgdal)
library(sf)
library(tidyverse)
library(openxlsx)
library(rgeos)
library(tiff)
library(raster)
library(exactextractr)
grid = readOGR("C:/Users/Charlotte Liotta/Desktop/cape_town/data_Cape_Town/data_maps/grid_reference_500.shp")
FU_5yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_undefended/FU_1in5.tif')
grid <- spTransform(grid, CRS(proj4string(FU_5yr)))
P_10yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/pluvial/P_1in10.tif')
P_10yr = crop(P_10yr, grid)
P_10yr <- reclassify(P_10yr, cbind(-9999, NA))
P_10yr <- reclassify(P_10yr, cbind(999, NA))
cellStats(P_10yr, 'min')
cellStats(P_10yr, 'max')
cellStats(P_10yr, 'mean')
prop_inondable_10yr = P_10yr
prop_inondable_10yr <- reclassify(prop_inondable_10yr, cbind(NA, 0))
prop_inondable_10yr <- reclassify(prop_inondable_10yr, cbind(0.005, 10, 1))
P_10yr_grid = extract(P_10yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_10yr_grid = data.frame(matrix(unlist(P_10yr_grid))[,1])
prop_inondable_10yr_grid = extract(prop_inondable_10yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_10yr_grid = data.frame(matrix(unlist(prop_inondable_10yr_grid))[,1])
P_10yr_grid$prop_inondable = prop_inondable_10yr_grid[,1]
colnames(P_10yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_10yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/P_10yr.xlsx')
P_20yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/pluvial/P_1in20.tif')
P_20yr = crop(P_20yr, grid)
P_20yr <- reclassify(P_20yr, cbind(-9999, NA))
P_20yr <- reclassify(P_20yr, cbind(999, NA))
cellStats(P_20yr, 'min')
cellStats(P_20yr, 'max')
cellStats(P_20yr, 'mean')
prop_inondable_20yr = P_20yr
prop_inondable_20yr <- reclassify(prop_inondable_20yr, cbind(NA, 0))
prop_inondable_20yr <- reclassify(prop_inondable_20yr, cbind(0.005, 10, 1))
P_20yr_grid = extract(P_20yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_20yr_grid = data.frame(matrix(unlist(P_20yr_grid))[,1])
prop_inondable_20yr_grid = extract(prop_inondable_20yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_20yr_grid = data.frame(matrix(unlist(prop_inondable_20yr_grid))[,1])
P_20yr_grid$prop_inondable = prop_inondable_20yr_grid[,1]
colnames(P_20yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_20yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/P_20yr.xlsx')
P_50yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/pluvial/P_1in50.tif')
P_50yr = crop(P_50yr, grid)
P_50yr <- reclassify(P_50yr, cbind(-9999, NA))
P_50yr <- reclassify(P_50yr, cbind(999, NA))
cellStats(P_50yr, 'min')
cellStats(P_50yr, 'max')
cellStats(P_50yr, 'mean')
prop_inondable_50yr = P_50yr
prop_inondable_50yr <- reclassify(prop_inondable_50yr, cbind(NA, 0))
prop_inondable_50yr <- reclassify(prop_inondable_50yr, cbind(0.005, 10, 1))
P_50yr_grid = extract(P_50yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_50yr_grid = data.frame(matrix(unlist(P_50yr_grid))[,1])
prop_inondable_50yr_grid = extract(prop_inondable_50yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_50yr_grid = data.frame(matrix(unlist(prop_inondable_50yr_grid))[,1])
P_50yr_grid$prop_inondable = prop_inondable_50yr_grid[,1]
colnames(P_50yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_50yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/P_50yr.xlsx')
P_75yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/pluvial/P_1in75.tif')
P_75yr = crop(P_75yr, grid)
P_75yr <- reclassify(P_75yr, cbind(-9999, NA))
P_75yr <- reclassify(P_75yr, cbind(999, NA))
cellStats(P_75yr, 'min')
cellStats(P_75yr, 'max')
cellStats(P_75yr, 'mean')
prop_inondable_75yr = P_75yr
prop_inondable_75yr <- reclassify(prop_inondable_75yr, cbind(NA, 0))
prop_inondable_75yr <- reclassify(prop_inondable_75yr, cbind(0.005, 10, 1))
P_75yr_grid = extract(P_75yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_75yr_grid = data.frame(matrix(unlist(P_75yr_grid))[,1])
prop_inondable_75yr_grid = extract(prop_inondable_75yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_75yr_grid = data.frame(matrix(unlist(prop_inondable_75yr_grid))[,1])
P_75yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_75yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_75yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/P_75yr.xlsx')
P_75yr_grid$prop_inondable = prop_inondable_75yr_grid[,1]
colnames(P_75yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_75yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/P_75yr.xlsx')
P_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/pluvial/P_1in200.tif')
P_100yr = crop(P_100yr, grid)
P_100yr <- reclassify(P_100yr, cbind(-9999, NA))
P_100yr <- reclassify(P_100yr, cbind(999, NA))
cellStats(P_100yr, 'min')
cellStats(P_100yr, 'max')
cellStats(P_100yr, 'mean')
prop_inondable_100yr = P_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
P_100yr_grid = extract(P_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_100yr_grid = data.frame(matrix(unlist(P_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
P_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/P_200yr.xlsx')
P_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/pluvial/P_1in250.tif')
P_100yr = crop(P_100yr, grid)
P_100yr <- reclassify(P_100yr, cbind(-9999, NA))
P_100yr <- reclassify(P_100yr, cbind(999, NA))
cellStats(P_100yr, 'min')
cellStats(P_100yr, 'max')
cellStats(P_100yr, 'mean')
prop_inondable_100yr = P_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
P_100yr_grid = extract(P_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_100yr_grid = data.frame(matrix(unlist(P_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
P_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/P_250yr.xlsx')
P_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/pluvial/P_1in500.tif')
P_100yr = crop(P_100yr, grid)
P_100yr <- reclassify(P_100yr, cbind(-9999, NA))
P_100yr <- reclassify(P_100yr, cbind(999, NA))
cellStats(P_100yr, 'min')
cellStats(P_100yr, 'max')
cellStats(P_100yr, 'mean')
prop_inondable_100yr = P_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
P_100yr_grid = extract(P_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_100yr_grid = data.frame(matrix(unlist(P_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
P_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/P_500yr.xlsx')
P_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/pluvial/P_1in1000.tif')
P_100yr = crop(P_100yr, grid)
P_100yr <- reclassify(P_100yr, cbind(-9999, NA))
P_100yr <- reclassify(P_100yr, cbind(999, NA))
cellStats(P_100yr, 'min')
cellStats(P_100yr, 'max')
cellStats(P_100yr, 'mean')
prop_inondable_100yr = P_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
P_100yr_grid = extract(P_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_100yr_grid = data.frame(matrix(unlist(P_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
P_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/P_1000yr.xlsx')
P_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_defended/FD_1in5.tif')
P_100yr = crop(P_100yr, grid)
P_100yr <- reclassify(P_100yr, cbind(-9999, NA))
P_100yr <- reclassify(P_100yr, cbind(999, NA))
cellStats(P_100yr, 'min')
cellStats(P_100yr, 'max')
cellStats(P_100yr, 'mean')
prop_inondable_100yr = P_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
P_100yr_grid = extract(P_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_100yr_grid = data.frame(matrix(unlist(P_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
P_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FD_5yr.xlsx')
P_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_defended/FD_1in10.tif')
P_100yr = crop(P_100yr, grid)
P_100yr <- reclassify(P_100yr, cbind(-9999, NA))
P_100yr <- reclassify(P_100yr, cbind(999, NA))
cellStats(P_100yr, 'min')
cellStats(P_100yr, 'max')
cellStats(P_100yr, 'mean')
prop_inondable_100yr = P_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
P_100yr_grid = extract(P_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_100yr_grid = data.frame(matrix(unlist(P_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
P_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FD_10yr.xlsx')
P_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_defended/FD_1in20.tif')
P_100yr = crop(P_100yr, grid)
P_100yr <- reclassify(P_100yr, cbind(-9999, NA))
P_100yr <- reclassify(P_100yr, cbind(999, NA))
cellStats(P_100yr, 'min')
cellStats(P_100yr, 'max')
cellStats(P_100yr, 'mean')
prop_inondable_100yr = P_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
P_100yr_grid = extract(P_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_100yr_grid = data.frame(matrix(unlist(P_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
P_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FD_20yr.xlsx')
P_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_defended/FD_1in50.tif')
P_100yr = crop(P_100yr, grid)
P_100yr <- reclassify(P_100yr, cbind(-9999, NA))
P_100yr <- reclassify(P_100yr, cbind(999, NA))
cellStats(P_100yr, 'min')
cellStats(P_100yr, 'max')
cellStats(P_100yr, 'mean')
prop_inondable_100yr = P_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
P_100yr_grid = extract(P_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_100yr_grid = data.frame(matrix(unlist(P_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
P_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FD_50yr.xlsx')
P_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_defended/FD_1in75.tif')
P_100yr = crop(P_100yr, grid)
P_100yr <- reclassify(P_100yr, cbind(-9999, NA))
P_100yr <- reclassify(P_100yr, cbind(999, NA))
cellStats(P_100yr, 'min')
cellStats(P_100yr, 'max')
cellStats(P_100yr, 'mean')
prop_inondable_100yr = P_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
P_100yr_grid = extract(P_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_100yr_grid = data.frame(matrix(unlist(P_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
P_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FD_75yr.xlsx')
P_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_defended/FD_1in100.tif')
P_100yr = crop(P_100yr, grid)
P_100yr <- reclassify(P_100yr, cbind(-9999, NA))
P_100yr <- reclassify(P_100yr, cbind(999, NA))
cellStats(P_100yr, 'min')
cellStats(P_100yr, 'max')
cellStats(P_100yr, 'mean')
prop_inondable_100yr = P_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
P_100yr_grid = extract(P_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_100yr_grid = data.frame(matrix(unlist(P_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
P_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FD_100yr.xlsx')
P_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_defended/FD_1in200.tif')
P_100yr = crop(P_100yr, grid)
P_100yr <- reclassify(P_100yr, cbind(-9999, NA))
P_100yr <- reclassify(P_100yr, cbind(999, NA))
cellStats(P_100yr, 'min')
cellStats(P_100yr, 'max')
cellStats(P_100yr, 'mean')
prop_inondable_100yr = P_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
P_100yr_grid = extract(P_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_100yr_grid = data.frame(matrix(unlist(P_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
P_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FD_200yr.xlsx')
P_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_defended/FD_1in250.tif')
P_100yr = crop(P_100yr, grid)
P_100yr <- reclassify(P_100yr, cbind(-9999, NA))
P_100yr <- reclassify(P_100yr, cbind(999, NA))
cellStats(P_100yr, 'min')
cellStats(P_100yr, 'max')
cellStats(P_100yr, 'mean')
prop_inondable_100yr = P_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
P_100yr_grid = extract(P_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_100yr_grid = data.frame(matrix(unlist(P_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
P_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FD_250yr.xlsx')
P_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_defended/FD_1in500.tif')
P_100yr = crop(P_100yr, grid)
P_100yr <- reclassify(P_100yr, cbind(-9999, NA))
P_100yr <- reclassify(P_100yr, cbind(999, NA))
cellStats(P_100yr, 'min')
cellStats(P_100yr, 'max')
cellStats(P_100yr, 'mean')
prop_inondable_100yr = P_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
P_100yr_grid = extract(P_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_100yr_grid = data.frame(matrix(unlist(P_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
P_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FD_500yr.xlsx')
P_100yr = raster('C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/South Africa/fluvial_defended/FD_1in1000.tif')
P_100yr = crop(P_100yr, grid)
P_100yr <- reclassify(P_100yr, cbind(-9999, NA))
P_100yr <- reclassify(P_100yr, cbind(999, NA))
cellStats(P_100yr, 'min')
cellStats(P_100yr, 'max')
cellStats(P_100yr, 'mean')
prop_inondable_100yr = P_100yr
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(NA, 0))
prop_inondable_100yr <- reclassify(prop_inondable_100yr, cbind(0.005, 10, 1))
P_100yr_grid = extract(P_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
P_100yr_grid = data.frame(matrix(unlist(P_100yr_grid))[,1])
prop_inondable_100yr_grid = extract(prop_inondable_100yr, grid, fun=mean, weights = TRUE, na.rm=TRUE)
prop_inondable_100yr_grid = data.frame(matrix(unlist(prop_inondable_100yr_grid))[,1])
P_100yr_grid$prop_inondable = prop_inondable_100yr_grid[,1]
colnames(P_100yr_grid) = c("flood_depth", "prop_flood_prone")
write.xlsx(P_100yr_grid, 'C:/Users/Charlotte Liotta/Desktop/cape_town/2. Data/FATHOM/FD_1000yr.xlsx')
library(rgdal)
library(sf)
library(tidyverse)
library(openxlsx)
library(rgeos)
library(tiff)
library(raster)
library(exactextractr)
grid = readOGR("C:/Users/Charlotte Liotta/Desktop/cape_town/data_Cape_Town/data_maps/grid_reference_500.shp")
library(rmatio)
scenario = read.mat("C:/Users/Charlotte Liotta/Desktop/Cape Town - pour Charlotte/Modèle/projet_le_cap/simulations - 201907.mat")
s1 = data.frame(scenario$initialState$householdsHousingType[[1]])
s1 = transpose(s1)
s1 = data.frame(s1)
s1 = data.frame(transpose(scenario$initialState$householdsHousingType[[1]]))
s1 = data.frame((scenario$initialState$householdsHousingType[[1]]))
s1 = transpose(s1)
s1 = data.frame(s1)
s1 = data.frame((scenario$initialState$householdsHousingType[[1]]))
s1 = data.frame((scenario$initialState$householdsHousingType[[1]]))
s1 = as.data.frame(t(as.matrix(s1)))
s1[1,]
View(s1)
sum(s1.V1)
sum(s1$V1)
sum((s1.V4))
sum(s1$V4)
sum(s1$V2)
sum(s1$V3)
formal = s1$V1
backyard = s1$V2
informal = s1$V3
subsidized = S4$V4
grid$formal_s1<- formal
subsidized = S1$V4
subsidized = s1$V4
grid$formal_s1<- formal
grid$formal_s1<- formal
grid$backyard_s1<- backyard
grid$informal_s1<- informal
grid$subsidized_s1<- subsidized
s1_data = data.frame((scenario$data$gridFormal[[1]]))
formal_data = data.frame((scenario$data$gridFormal[[1]]))
informal_data = data.frame((scenario$data$gridInormal[[1]]))
backyard_data = data.frame((scenario$data$gridBackyard[[1]]))
formal_data = data.frame((scenario$data$gridFormal[[1]]))
informal_data = data.frame((scenario$data$gridInformalSettlement[[1]]))
backyard_data = data.frame((scenario$data$gridInformalBackyard[[1]]))
grid$formal_data<- formal_data
grid$backyard_data<- backyard_data
grid$informal_data<- informal_data
write.shapefile(grid, "C:/Users/Charlotte Liotta/Desktop/cape_town/4. Sorties/data_simul.shp")
writeOGR(grid, "C:/Users/Charlotte Liotta/Desktop/cape_town/4. Sorties/data_simul", driver = "ESRI Shapefile")
formal_data[1]
grid$formal_data<- formal_data[1]
grid$backyard_data<- backyard_data
grid$informal_data<- informal_data
writeOGR(grid, "C:/Users/Charlotte Liotta/Desktop/cape_town/4. Sorties/data_simul", driver = "ESRI Shapefile")
grid$formal_data<- as.vector(formal_data)
grid$backyard_data<- backyard_data
grid$informal_data<- informal_data
writeOGR(grid, "C:/Users/Charlotte Liotta/Desktop/cape_town/4. Sorties/data_simul", driver = "ESRI Shapefile")
formal_data = scenario$data$gridFormal[[1]]
informal_data = data.frame((scenario$data$gridInformalSettlement[[1]]))
backyard_data = data.frame((scenario$data$gridInformalBackyard[[1]]))
grid$formal_data<- as.vector(formal_data)
grid$backyard_data<- backyard_data
grid$informal_data<- informal_data
writeOGR(grid, "C:/Users/Charlotte Liotta/Desktop/cape_town/4. Sorties/data_simul", driver = "ESRI Shapefile")
formal_data = scenario$data$gridFormal[[1]]
informal_data = scenario$data$gridInformalSettlement[[1]]
backyard_data = scenario$data$gridInformalBackyard[[1]]
grid$formal_data<- as.vector(formal_data)
grid$backyard_data<- backyard_data
grid$informal_data<- informal_data
writeOGR(grid, "C:/Users/Charlotte Liotta/Desktop/cape_town/4. Sorties/data_simul", driver = "ESRI Shapefile")
writeOGR(grid, "C:/Users/Charlotte Liotta/Desktop/cape_town/4. Sorties/data_simul", driver = "ESRI Shapefile", layer = "data_simul")
sum(grid.formal_data)
sum(grid@data$formal_data)
grid$erreur_informal = informal_data - scenario$data$gridInformalSettlement[[1]]
grid$erreur_informal = informal_data - scenario$data$gridInformalSettlement[[1]]
grid$erreur_backyard = backyard_data - scenario$data$gridInformalBackyard[[1]]
writeOGR(grid, "C:/Users/Charlotte Liotta/Desktop/cape_town/4. Sorties/data_simul", driver = "ESRI Shapefile", layer = "data_simul")
writeOGR(grid, "C:/Users/Charlotte Liotta/Desktop/cape_town/4. Sorties/data_simul", driver = "ESRI Shapefile", layer = "error")
nformal_data - scenario$data$gridInformalSettlement[[1]]
informal_data - scenario$data$gridInformalSettlement[[1]]
max(informal_data - scenario$data$gridInformalSettlement[[1]])
max(informal_data - informal)
grid$erreur_informal = informal_data - informal
grid$erreur_backyard = backyard_data - backyard
writeOGR(grid, "C:/Users/Charlotte Liotta/Desktop/cape_town/4. Sorties/data_simul", driver = "ESRI Shapefile", layer = "error")
library(rgdal)
library(sf)
library(tidyverse)
library(openxlsx)
library(rgeos)
library(tiff)
library(raster)
library(exactextractr)
read.csv("C:/Users/Charlotte Liotta/Desktop/cape_town/hh_type.csv")
read.csv("C:/Users/Charlotte Liotta/Desktop/cape_town/hhtype.csv")
simul_charlotte = read.csv("C:/Users/Charlotte Liotta/Desktop/cape_town/hhtype.csv")
simul_charlotte[1]
sum(simul_charlotte[1])
sum(simul_charlotte[2])
sum(simul_charlotte[3])
sum(simul_charlotte[4])
grid$formal_charlotte = simul_charlotte[1]
grid$backyard_charlotte = simul_charlotte[2]
grid$informal_charlotte = simul_charlotte[3]
grid$subsidized_charlotte = simul_charlotte[4]
as.matrix(simul_charlotte[1])
grid$formal_charlotte = as.matrix(simul_charlotte[1])
simul_charlotte[1]
grid = readOGR("C:/Users/Charlotte Liotta/Desktop/cape_town/data_Cape_Town/data_maps/grid_reference_500.shp")
grid$formal_charlotte = as.matrix(simul_charlotte[1])
simul_charlotte = read.csv("C:/Users/Charlotte Liotta/Desktop/cape_town/hhtype.csv", header = FALSE)
grid$formal_charlotte = as.matrix(simul_charlotte[1])
grid$backyard_charlotte = simul_charlotte[2]
grid$informal_charlotte = simul_charlotte[3]
grid$subsidized_charlotte = simul_charlotte[4]
writeOGR(grid, "C:/Users/Charlotte Liotta/Desktop/cape_town/4. Sorties/SIMUL_CHARLOTTE", driver = "ESRI Shapefile", layer = "error")
grid$formal_charlotte = as.vector(simul_charlotte[1])
grid$backyard_charlotte = simul_charlotte[2]
grid$informal_charlotte = simul_charlotte[3]
grid$subsidized_charlotte = simul_charlotte[4]
writeOGR(grid, "C:/Users/Charlotte Liotta/Desktop/cape_town/4. Sorties/SIMUL_CHARLOTTE", driver = "ESRI Shapefile", layer = "error")
grid$formal_charlotte = simul_charlotte$V1
grid$backyard_charlotte = simul_charlotte$V2
grid$informal_charlotte = simul_charlotte$V3
grid$subsidized_charlotte = simul_charlotte$V4
writeOGR(grid, "C:/Users/Charlotte Liotta/Desktop/cape_town/4. Sorties/SIMUL_CHARLOTTE", driver = "ESRI Shapefile", layer = "error")
